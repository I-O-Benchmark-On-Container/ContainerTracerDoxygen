<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ContainerTracer: Container Tracer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ContainerTracer
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Container Tracer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://www.codacy.com/gh/I-O-Benchmark-On-Container/ContainerTracer?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=I-O-Benchmark-On-Container/ContainerTracer&amp;amp;utm_campaign=Badge_Grade"></a> <a href="https://travis-ci.org/I-O-Benchmark-On-Container/ContainerTracer"></a></p>
<p>Container Tracer는 각 **장치의 컨테이너 별 I/O 성능**을 측정하는 도구로 기존의 fio나 filebench의 부족한 cgroup 별 I/O 성능 측정 기능을 보완하는 프로그램입니다.</p>
<p>Container Tracer는 장치의 컨테이너 별 I/O 성능을 측정하기 위해서 <a href="https://github.com/yongseokoh/trace-replay">trace-replay</a>를 사용합니다.</p>
<h2>프로젝트의 구성</h2>
<p>프로젝트의 구성은 아래와 같습니다.</p>
<ul>
<li><b>trace-replay:</b> <a href="https://github.com/yongseokoh/trace-replay">trace-replay</a>의 코드로 기존의 비정형 데이터가 아닌 정형 데이터로 출력하게 변경되어 있습니다.</li>
<li><b>runner:</b> container를 생성한 후에 정형 데이터를 출력하는 trace-replay를 각각의 container에 동작시키는 프로그램입니다.</li>
<li><b>web:</b> 파이썬의 Flask로 개발되어 있으며, runner에서 받은 데이터를 웹으로 실시간 출력을 하는 역할을 합니다.</li>
<li><b>setting</b>: Scons 빌드의 전역 환경 설정이 들어있는 폴더입니다.</li>
<li><b>include</b>: C로 작성된 소스 코드의 헤더가 들어가는 위치입니다. 모든 헤더는 해당 위치에 있어야 합니다.</li>
</ul>
<p>각 폴더의 하위 항목으로 있는 **test**에는 단위 테스트 파일이 들어가게 됩니다.</p>
<h2>빌드 방법</h2>
<p>공통적으로는 아래를 수행해주셔야 합니다.</p>
<div class="fragment"><div class="line">sudo pip3 install black flake8</div><div class="line">sudo apt install doxygen</div></div><!-- fragment --><h3>web의 경우</h3>
<p>Flask를 사용하기 때문에 반드시 아래를 수행해주셔야 합니다.</p>
<div class="fragment"><div class="line">sudo pip3 install flask flask_restful</div></div><!-- fragment --><h3>trace-replay나 runner의 경우</h3>
<p>소스 코드를 다운 받은 후에 빌드에 필요한 프로그램을 설치하도록 합니다.</p>
<div class="fragment"><div class="line">sudo pip3 install scons scons-compiledb</div><div class="line">sudo pip3 install clang-format</div><div class="line">sudo apt install cppcheck libaio-dev libjson-c-dev libjemalloc-dev</div></div><!-- fragment --><p>그리고 아래의 명령을 통해서 빌드 및 테스트를 수행합니다.</p>
<div class="fragment"><div class="line">sudo scons -c</div><div class="line">sudo scons test DEBUG=True</div></div><!-- fragment --><p>배포판을 만드는 경우에는 아래와 같은 방법으로 진행해주시길 바랍니다.</p>
<div class="fragment"><div class="line">sudo scons -c</div><div class="line">scons</div></div><!-- fragment --><h4>참고 사항</h4>
<ul>
<li><code>DEBUG=True</code>를 주게되면 모든 로그가 다 출력되어 좀 더 수월하게 디버깅이 가능해집니다.</li>
<li><code>sudo</code>를 주는 이유는 <code>trace-replay</code>가 실행되기 위해서는 <code>sudo</code> 권한을 필요로 하기 때문입니다.</li>
<li><code>sudo scons test</code>를 하면 <code>compile_commands.json</code>이 생성되지 않으므로 생성을 원하는 경우 <code>scons</code>를 수행해주시길 바랍니다.</li>
</ul>
<h4>유의 사항</h4>
<p><em><b>trace replay는 Direct-IO를 수행하므로 동작 과정에서 사용자 디스크의 파일 시스템을 붕괴 시킵니다. 따라서, 파일 시스템이 구축되지 않은 디스크 및 백업이 간편한 가상 환경에서 수행해주시길 바랍니다</b></em></p>
<h2>사용 라이브러리</h2>
<ol type="1">
<li>pthread: trace-replay 동작용 POSIX 라이브러리</li>
</ol>
<ol type="1">
<li>AIO: asynchronous I/O 라이브러리</li>
</ol>
<ol type="1">
<li>rt: Real-Time 라이브러리</li>
</ol>
<ol type="1">
<li><a href="https://github.com/json-c/json-c">json-c</a>: C용 json 라이브러리</li>
</ol>
<ol type="1">
<li><a href="https://github.com/ThrowTheSwitch/Unity">unity</a>: C용 unit test 라이브러리</li>
</ol>
<ol type="1">
<li><a href="https://github.com/jemalloc/jemalloc">jemalloc</a>: 효율적인 메모리 동적 할당을 해주는 라이브러리</li>
</ol>
<h2>코드 기여 규칙</h2>
<p>trace-replay를 제외한 모든 코드는 <a href="https://www.doxygen.nl/index.html">Doxygen</a>으로 문서화를 진행하셔야 합니다.</p>
<h3>web 코드 기여 규칙</h3>
<p>가능하면 모듈에 대해서 테스트 파일을 만들어서 <code>web/test</code> 위치에 넣어주시길 바라며, 반드시 해당 테스트 파일은 **<code>pytest</code> 규격으로 작성**하셔서 테스트를 진행해주시길 바랍니다.</p>
<p>black 포맷팅을 진행한 후에 flake8 검사를 실시한 후에 문제가 없는 경우 PR을 진행합니다. 기본적으로, <code>pre-commit</code>으로 등록되어 있기 때문에 별도로 처리할 필요는 없습니다. 만약, 동작하지 않는 경우에는 아래의 조치를 수행해주시길 바랍니다.</p>
<ol type="1">
<li><code>pip3 install pre-commit</code>을 수행해줍니다.</li>
</ol>
<ol type="1">
<li><code>pre-commit install</code>을 수행해주시길 바랍니다.</li>
</ol>
<h3>trace-replay나 runner의 코드 기여 규칙</h3>
<p>trace-replay나 runner의 경우에 반드시 아래 절차를 확인한 후에 PR을 진행해야 합니다.</p>
<ol type="1">
<li><code>sudo scons test</code>를 반드시 수행한 후에 <code>build/log</code> 또는 출력에서 발생하는 모든 치명적인 오류는 반드시 수정되어야 합니다.</li>
</ol>
<ol type="1">
<li>프로젝트 최상위 폴더에서 <code>sudo valgrind --leak-check=full --show-leak-kinds=all ./build/release/&lt;PROGRAM&gt;</code>를 수행하여 메모리 누수를 확인하셔야 합니다.</li>
</ol>
<ol type="1">
<li>되도록 비교 구문 작성 시에는 <code>if (상수 == 변수)</code>의 형태로 작성해주시길 바랍니다.</li>
</ol>
<p><a href="https://clang.llvm.org/docs/ClangFormat.html">clang-format</a>은 <code>pip install clang-format</code>으로 설치할 수 있고, <a href="http://cppcheck.sourceforge.net/">cppcheck</a>의 경우에는 <code>sudo apt install cppcheck</code>를 통해 설치 가능합니다. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
